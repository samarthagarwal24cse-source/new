<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electronic Medical Record System</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f7f9fc;
      text-align: center;
    }
    h1 {
      color: #2c3e50;
      margin-bottom: 20px;
    }
    #reader {
      width: 300px;
      margin: 0 auto 20px;
      border: 2px solid #2c3e50;
      border-radius: 10px;
      padding: 10px;
      background: white;
    }
    .patient-card {
      display: none;
      border: 2px solid #2c3e50;
      border-radius: 10px;
      padding: 15px;
      width: 320px;
      margin: 0 auto;
      background: #ecf0f1;
      text-align: left;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
    }
    .patient-card h3 {
      margin: 0 0 10px;
      color: #34495e;
    }
    .patient-card p {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h1>Electronic Medical Record System</h1>
  
  <div id="reader"></div>
  
  <div id="patient-data" class="patient-card"></div>

  <script>
    // Show patient info inside the card
    function showPatientData(patient) {
      const card = document.getElementById("patient-data");
      card.style.display = "block";
      card.innerHTML = `
        <h3>${patient.name} (ID: ${patient.id})</h3>
        <p><b>Age:</b> ${patient.age}</p>
        <p><b>Gender:</b> ${patient.gender}</p>
        <p><b>Blood Group:</b> ${patient.blood_group}</p>
        <p><b>Medical History:</b> ${patient.medical_history}</p>
        <p><b>Prescription:</b> ${patient.prescriptions}</p>
      `;
    }

    // Dummy database for demo
    function fetchPatient(id) {
      const dummyDB = {
        "101": {id:101, name:"John Doe", age:32, gender:"Male", blood_group:"O+", medical_history:"Diabetes", prescriptions:"Metformin"},
        "102": {id:102, name:"Jane Smith", age:28, gender:"Female", blood_group:"A-", medical_history:"Asthma", prescriptions:"Inhaler"},
        "103": {id:103, name:"Arjun Mehta", age:45, gender:"Male", blood_group:"B+", medical_history:"Hypertension", prescriptions:"Amlodipine"}
      };
      if(dummyDB[id]) {
        showPatientData(dummyDB[id]);
      } else {
        alert("Patient not found!");
      }
    }

    // QR Scanner
    const html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" }, 
      { fps: 10, qrbox: 250 },
      (decodedText) => {
        html5QrCode.stop(); // stop scanner after reading
        fetchPatient(decodedText); // Use decoded QR text as Patient ID
      },
      (errorMessage) => {
        // ignore scan errors
      }
    );
  </script>
</body>
</html>

